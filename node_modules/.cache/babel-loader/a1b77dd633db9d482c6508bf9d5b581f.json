{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/HP/Downloads/filmpire-l2-forked/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/HP/Downloads/filmpire-l2-forked/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/HP/Downloads/filmpire-l2-forked/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useContext,useEffect,useState}from\"react\";import{AppBar,IconButton,Toolbar,Drawer,Button,Avatar,useMediaQuery}from\"@mui/material\";import{Menu,AccountCircle,Brightness4,Brightness7}from\"@mui/icons-material\";import{Link}from\"react-router-dom\";import{useTheme}from\"@mui/material/styles\";import{useDispatch,useSelector}from\"react-redux\";import{ColorModeContext}from\"../../utils/ToggleColorMode\";import{setUser,userSelector}from\"../../features/auth\";import{Sidebar,Search}from\"..\";import{fetchToken,createSessionId,moviesApi}from\"../../utils\";import useStyles from\"./styles\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var NavBar=function NavBar(){var _useSelector=useSelector(userSelector),isAuthenticated=_useSelector.isAuthenticated,user=_useSelector.user;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),mobileOpen=_useState2[0],setMobileOpen=_useState2[1];var classes=useStyles();var isMobile=useMediaQuery(\"(max-width:600px)\");var theme=useTheme();var dispatch=useDispatch();var colorMode=useContext(ColorModeContext);var token=localStorage.getItem(\"request_token\");var sessionIdFromLocalStorage=localStorage.getItem(\"session_id\");useEffect(function(){var logInUser=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$moviesApi$get,userData,sessionId,_yield$moviesApi$get2,_userData;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!token){_context.next=17;break;}if(!sessionIdFromLocalStorage){_context.next=9;break;}_context.next=4;return moviesApi.get(\"/account?session_id=\".concat(sessionIdFromLocalStorage));case 4:_yield$moviesApi$get=_context.sent;userData=_yield$moviesApi$get.data;dispatch(setUser(userData));_context.next=17;break;case 9:_context.next=11;return createSessionId();case 11:sessionId=_context.sent;_context.next=14;return moviesApi.get(\"/account?session_id=\".concat(sessionId));case 14:_yield$moviesApi$get2=_context.sent;_userData=_yield$moviesApi$get2.data;dispatch(setUser(_userData));case 17:case\"end\":return _context.stop();}}},_callee);}));return function logInUser(){return _ref.apply(this,arguments);};}();logInUser();},[token]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(AppBar,{position:\"fixed\",children:/*#__PURE__*/_jsxs(Toolbar,{className:classes.toolbar,children:[isMobile&&/*#__PURE__*/_jsx(IconButton,{color:\"inherit\",edge:\"start\",style:{outline:\"none\"},onClick:function onClick(){return setMobileOpen(function(prevMobileOpen){return!prevMobileOpen;});},className:classes.menuButton,children:/*#__PURE__*/_jsx(Menu,{})}),/*#__PURE__*/_jsx(IconButton,{color:\"inherit\",sx:{ml:1},onClick:colorMode.toggleColorMode,children:theme.palette.mode===\"dark\"?/*#__PURE__*/_jsx(Brightness7,{}):/*#__PURE__*/_jsx(Brightness4,{})}),!isMobile&&/*#__PURE__*/_jsx(Search,{}),/*#__PURE__*/_jsx(\"div\",{children:!isAuthenticated?/*#__PURE__*/_jsxs(Button,{color:\"inherit\",onClick:fetchToken,children:[\"Login \\xA0 \",/*#__PURE__*/_jsx(AccountCircle,{})]}):/*#__PURE__*/_jsxs(Button,{color:\"inherit\",component:Link,to:\"/profile/\".concat(user.id),className:classes.linkButton,onClick:function onClick(){},children:[!isMobile&&/*#__PURE__*/_jsx(_Fragment,{children:\" My Movies \\xA0\"}),/*#__PURE__*/_jsx(Avatar,{style:{width:30,height:30},alt:\"Profile\",src:\"https://cdn.pixabay.com/photo/2016/08/08/09/17/avatar-1577909_1280.png\"})]})}),isMobile&&/*#__PURE__*/_jsx(Search,{})]})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"nav\",{className:classes.drawer,children:isMobile?/*#__PURE__*/_jsx(Drawer,{variant:\"temporary\",anchor:\"right\",open:mobileOpen,onClose:function onClose(){return setMobileOpen(function(prevMobileOpen){return!prevMobileOpen;});},classes:{paper:classes.drawerPaper},ModelProps:{keepMounted:true},children:/*#__PURE__*/_jsx(Sidebar,{setMobileOpen:setMobileOpen})}):/*#__PURE__*/_jsx(Drawer,{classes:{paper:classes.drawerPaper},variant:\"permanent\",open:true,children:/*#__PURE__*/_jsx(Sidebar,{setMobileOpen:setMobileOpen})})})})]});};export default NavBar;","map":{"version":3,"sources":["C:/Users/HP/Downloads/filmpire-l2-forked/src/components/NavBar/NavBar.jsx"],"names":["React","useContext","useEffect","useState","AppBar","IconButton","Toolbar","Drawer","Button","Avatar","useMediaQuery","Menu","AccountCircle","Brightness4","Brightness7","Link","useTheme","useDispatch","useSelector","ColorModeContext","setUser","userSelector","Sidebar","Search","fetchToken","createSessionId","moviesApi","useStyles","NavBar","isAuthenticated","user","mobileOpen","setMobileOpen","classes","isMobile","theme","dispatch","colorMode","token","localStorage","getItem","sessionIdFromLocalStorage","logInUser","get","userData","data","sessionId","toolbar","outline","prevMobileOpen","menuButton","ml","toggleColorMode","palette","mode","id","linkButton","width","height","drawer","paper","drawerPaper","keepMounted"],"mappings":"0dAAA,MAAOA,CAAAA,KAAP,EAAgBC,UAAhB,CAA4BC,SAA5B,CAAuCC,QAAvC,KAAuD,OAAvD,CACA,OAASC,MAAT,CAAiBC,UAAjB,CAA6BC,OAA7B,CAAsCC,MAAtC,CAA8CC,MAA9C,CAAsDC,MAAtD,CAA8DC,aAA9D,KAAmF,eAAnF,CACA,OAASC,IAAT,CAAeC,aAAf,CAA8BC,WAA9B,CAA2CC,WAA3C,KAA8D,qBAA9D,CACA,OAASC,IAAT,KAAqB,kBAArB,CACA,OAASC,QAAT,KAAyB,sBAAzB,CACA,OAASC,WAAT,CAAsBC,WAAtB,KAAyC,aAAzC,CAEA,OAASC,gBAAT,KAAiC,6BAAjC,CACA,OAASC,OAAT,CAAkBC,YAAlB,KAAsC,qBAAtC,CACA,OAASC,OAAT,CAAkBC,MAAlB,KAAgC,IAAhC,CACA,OAASC,UAAT,CAAqBC,eAArB,CAAsCC,SAAtC,KAAuD,aAAvD,CACA,MAAOC,CAAAA,SAAP,KAAsB,UAAtB,C,6IAEA,GAAMC,CAAAA,MAAM,CAAG,QAATA,CAAAA,MAAS,EAAM,CACnB,iBAAkCV,WAAW,CAACG,YAAD,CAA7C,CAAQQ,eAAR,cAAQA,eAAR,CAAyBC,IAAzB,cAAyBA,IAAzB,CACA,cAAoC3B,QAAQ,CAAC,KAAD,CAA5C,wCAAO4B,UAAP,eAAmBC,aAAnB,eACA,GAAMC,CAAAA,OAAO,CAAGN,SAAS,EAAzB,CACA,GAAMO,CAAAA,QAAQ,CAAGxB,aAAa,CAAC,mBAAD,CAA9B,CACA,GAAMyB,CAAAA,KAAK,CAAGnB,QAAQ,EAAtB,CACA,GAAMoB,CAAAA,QAAQ,CAAGnB,WAAW,EAA5B,CAEA,GAAMoB,CAAAA,SAAS,CAAGpC,UAAU,CAACkB,gBAAD,CAA5B,CAEA,GAAMmB,CAAAA,KAAK,CAAGC,YAAY,CAACC,OAAb,CAAqB,eAArB,CAAd,CACA,GAAMC,CAAAA,yBAAyB,CAAGF,YAAY,CAACC,OAAb,CAAqB,YAArB,CAAlC,CAEAtC,SAAS,CAAC,UAAM,CACd,GAAMwC,CAAAA,SAAS,0FAAG,mNACZJ,KADY,8BAEVG,yBAFU,+CAGqBf,CAAAA,SAAS,CAACiB,GAAV,+BAAqCF,yBAArC,EAHrB,2CAGEG,QAHF,sBAGJC,IAHI,CAIZT,QAAQ,CAAChB,OAAO,CAACwB,QAAD,CAAR,CAAR,CAJY,qDAMYnB,CAAAA,eAAe,EAN3B,SAMNqB,SANM,sCAQqBpB,CAAAA,SAAS,CAACiB,GAAV,+BAAqCG,SAArC,EARrB,6CAQEF,SARF,uBAQJC,IARI,CASZT,QAAQ,CAAChB,OAAO,CAACwB,SAAD,CAAR,CAAR,CATY,uDAAH,kBAATF,CAAAA,SAAS,0CAAf,CAcAA,SAAS,GACV,CAhBQ,CAgBN,CAACJ,KAAD,CAhBM,CAAT,CAkBA,mBACE,wCACE,KAAC,MAAD,EAAQ,QAAQ,CAAC,OAAjB,uBACE,MAAC,OAAD,EAAS,SAAS,CAAEL,OAAO,CAACc,OAA5B,WACGb,QAAQ,eACP,KAAC,UAAD,EAAY,KAAK,CAAC,SAAlB,CAA4B,IAAI,CAAC,OAAjC,CAAyC,KAAK,CAAE,CAAEc,OAAO,CAAE,MAAX,CAAhD,CAAqE,OAAO,CAAE,yBAAMhB,CAAAA,aAAa,CAAC,SAACiB,cAAD,QAAoB,CAACA,cAArB,EAAD,CAAnB,EAA9E,CAAwI,SAAS,CAAEhB,OAAO,CAACiB,UAA3J,uBACE,KAAC,IAAD,IADF,EAFJ,cAME,KAAC,UAAD,EAAY,KAAK,CAAC,SAAlB,CAA4B,EAAE,CAAE,CAAEC,EAAE,CAAE,CAAN,CAAhC,CAA2C,OAAO,CAAEd,SAAS,CAACe,eAA9D,UACGjB,KAAK,CAACkB,OAAN,CAAcC,IAAd,GAAuB,MAAvB,cAAgC,KAAC,WAAD,IAAhC,cAAkD,KAAC,WAAD,IADrD,EANF,CASG,CAACpB,QAAD,eAAa,KAAC,MAAD,IAThB,cAUE,qBACG,CAACL,eAAD,cACC,MAAC,MAAD,EAAQ,KAAK,CAAC,SAAd,CAAwB,OAAO,CAAEL,UAAjC,sCACe,KAAC,aAAD,IADf,GADD,cAKC,MAAC,MAAD,EAAQ,KAAK,CAAC,SAAd,CAAwB,SAAS,CAAET,IAAnC,CAAyC,EAAE,oBAAce,IAAI,CAACyB,EAAnB,CAA3C,CAAoE,SAAS,CAAEtB,OAAO,CAACuB,UAAvF,CAAmG,OAAO,CAAE,kBAAM,CAAE,CAApH,WACG,CAACtB,QAAD,eAAa,4CADhB,cAEE,KAAC,MAAD,EAAQ,KAAK,CAAE,CAAEuB,KAAK,CAAE,EAAT,CAAaC,MAAM,CAAE,EAArB,CAAf,CAA0C,GAAG,CAAC,SAA9C,CAAwD,GAAG,CAAC,wEAA5D,EAFF,GANJ,EAVF,CAsBGxB,QAAQ,eAAI,KAAC,MAAD,IAtBf,GADF,EADF,cA2BE,kCACE,YAAK,SAAS,CAAED,OAAO,CAAC0B,MAAxB,UACGzB,QAAQ,cACP,KAAC,MAAD,EAAQ,OAAO,CAAC,WAAhB,CAA4B,MAAM,CAAC,OAAnC,CAA2C,IAAI,CAAEH,UAAjD,CAA6D,OAAO,CAAE,yBAAMC,CAAAA,aAAa,CAAC,SAACiB,cAAD,QAAoB,CAACA,cAArB,EAAD,CAAnB,EAAtE,CAAgI,OAAO,CAAE,CAAEW,KAAK,CAAE3B,OAAO,CAAC4B,WAAjB,CAAzI,CAAyK,UAAU,CAAE,CAAEC,WAAW,CAAE,IAAf,CAArL,uBACE,KAAC,OAAD,EAAS,aAAa,CAAE9B,aAAxB,EADF,EADO,cAKP,KAAC,MAAD,EAAQ,OAAO,CAAE,CAAE4B,KAAK,CAAE3B,OAAO,CAAC4B,WAAjB,CAAjB,CAAiD,OAAO,CAAC,WAAzD,CAAqE,IAAI,KAAzE,uBACE,KAAC,OAAD,EAAS,aAAa,CAAE7B,aAAxB,EADF,EANJ,EADF,EA3BF,GADF,CA2CD,CA1ED,CA4EA,cAAeJ,CAAAA,MAAf","sourcesContent":["import React, { useContext, useEffect, useState } from \"react\";\nimport { AppBar, IconButton, Toolbar, Drawer, Button, Avatar, useMediaQuery } from \"@mui/material\";\nimport { Menu, AccountCircle, Brightness4, Brightness7 } from \"@mui/icons-material\";\nimport { Link } from \"react-router-dom\";\nimport { useTheme } from \"@mui/material/styles\";\nimport { useDispatch, useSelector } from \"react-redux\";\n\nimport { ColorModeContext } from \"../../utils/ToggleColorMode\";\nimport { setUser, userSelector } from \"../../features/auth\";\nimport { Sidebar, Search } from \"..\";\nimport { fetchToken, createSessionId, moviesApi } from \"../../utils\";\nimport useStyles from \"./styles\";\n\nconst NavBar = () => {\n  const { isAuthenticated, user } = useSelector(userSelector);\n  const [mobileOpen, setMobileOpen] = useState(false);\n  const classes = useStyles();\n  const isMobile = useMediaQuery(\"(max-width:600px)\");\n  const theme = useTheme();\n  const dispatch = useDispatch();\n\n  const colorMode = useContext(ColorModeContext);\n\n  const token = localStorage.getItem(\"request_token\");\n  const sessionIdFromLocalStorage = localStorage.getItem(\"session_id\");\n\n  useEffect(() => {\n    const logInUser = async () => {\n      if (token) {\n        if (sessionIdFromLocalStorage) {\n          const { data: userData } = await moviesApi.get(`/account?session_id=${sessionIdFromLocalStorage}`);\n          dispatch(setUser(userData));\n        } else {\n          const sessionId = await createSessionId();\n\n          const { data: userData } = await moviesApi.get(`/account?session_id=${sessionId}`);\n          dispatch(setUser(userData));\n        }\n      }\n    };\n\n    logInUser();\n  }, [token]);\n\n  return (\n    <>\n      <AppBar position=\"fixed\">\n        <Toolbar className={classes.toolbar}>\n          {isMobile && (\n            <IconButton color=\"inherit\" edge=\"start\" style={{ outline: \"none\" }} onClick={() => setMobileOpen((prevMobileOpen) => !prevMobileOpen)} className={classes.menuButton}>\n              <Menu />\n            </IconButton>\n          )}\n          <IconButton color=\"inherit\" sx={{ ml: 1 }} onClick={colorMode.toggleColorMode}>\n            {theme.palette.mode === \"dark\" ? <Brightness7 /> : <Brightness4 />}\n          </IconButton>\n          {!isMobile && <Search />}\n          <div>\n            {!isAuthenticated ? (\n              <Button color=\"inherit\" onClick={fetchToken}>\n                Login &nbsp; <AccountCircle />\n              </Button>\n            ) : (\n              <Button color=\"inherit\" component={Link} to={`/profile/${user.id}`} className={classes.linkButton} onClick={() => {}}>\n                {!isMobile && <> My Movies &nbsp;</>}\n                <Avatar style={{ width: 30, height: 30 }} alt=\"Profile\" src=\"https://cdn.pixabay.com/photo/2016/08/08/09/17/avatar-1577909_1280.png\" />\n              </Button>\n            )}\n          </div>\n          {isMobile && <Search />}\n        </Toolbar>\n      </AppBar>\n      <div>\n        <nav className={classes.drawer}>\n          {isMobile ? (\n            <Drawer variant=\"temporary\" anchor=\"right\" open={mobileOpen} onClose={() => setMobileOpen((prevMobileOpen) => !prevMobileOpen)} classes={{ paper: classes.drawerPaper }} ModelProps={{ keepMounted: true }}>\n              <Sidebar setMobileOpen={setMobileOpen}></Sidebar>\n            </Drawer>\n          ) : (\n            <Drawer classes={{ paper: classes.drawerPaper }} variant=\"permanent\" open>\n              <Sidebar setMobileOpen={setMobileOpen}></Sidebar>\n            </Drawer>\n          )}\n        </nav>\n      </div>\n    </>\n  );\n};\n\nexport default NavBar;\n"]},"metadata":{},"sourceType":"module"}